shadow$provide.module$node_modules$d3_delaunay$src$voronoi=function(global,require,module,exports){function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{"default":obj}}function _slicedToArray(arr,i){var JSCompiler_temp=Array.isArray(arr)?arr:void 0;if(!JSCompiler_temp)if(Symbol.iterator in Object(arr)||"[object Arguments]"===Object.prototype.toString.call(arr)){JSCompiler_temp=[];var _n=!0,_d=!1,_e=void 0;try{for(var _i=arr[Symbol.iterator](),_s;!(_n=(_s=_i.next()).done)&&(JSCompiler_temp.push(_s.value),
!i||JSCompiler_temp.length!==i);_n=!0);}catch(err){_d=!0,_e=err}finally{try{if(!_n&&null!=_i["return"])_i["return"]()}finally{if(_d)throw _e;}}}else JSCompiler_temp=void 0;if(!(arr=JSCompiler_temp))throw new TypeError("Invalid attempt to destructure non-iterable instance");return arr}function _defineProperties(target,props){for(var i=0;i<props.length;i++){var descriptor=props[i];descriptor.enumerable=descriptor.enumerable||!1;descriptor.configurable=!0;"value"in descriptor&&(descriptor.writable=!0);
Object.defineProperty(target,descriptor.key,descriptor)}}function _createClass(Constructor,protoProps,staticProps){protoProps&&_defineProperties(Constructor.prototype,protoProps);staticProps&&_defineProperties(Constructor,staticProps);return Constructor}Object.defineProperty(exports,"__esModule",{value:!0});exports["default"]=void 0;var _path=_interopRequireDefault(require("module$node_modules$d3_delaunay$src$path")),_polygon=_interopRequireDefault(require("module$node_modules$d3_delaunay$src$polygon"));
global=function(){function Voronoi(delaunay){var _ref2=_slicedToArray(1<arguments.length&&void 0!==arguments[1]?arguments[1]:[0,0,960,500],4),xmin=_ref2[0],ymin=_ref2[1],xmax=_ref2[2];_ref2=_ref2[3];if(!(this instanceof Voronoi))throw new TypeError("Cannot call a class as a function");if(!((xmax=+xmax)>=(xmin=+xmin)&&(_ref2=+_ref2)>=(ymin=+ymin)))throw Error("invalid bounds");this.delaunay=delaunay;this._circumcenters=new Float64Array(2*delaunay.points.length);this.vectors=new Float64Array(2*delaunay.points.length);
this.xmax=xmax;this.xmin=xmin;this.ymax=_ref2;this.ymin=ymin;this._init()}_createClass(Voronoi,[{key:"update",value:function(){this.delaunay.update();this._init();return this}},{key:"_init",value:function(){var _this$delaunay=this.delaunay,points=_this$delaunay.points,hull=_this$delaunay.hull,triangles=_this$delaunay.triangles;_this$delaunay=this.vectors;for(var circumcenters=this.circumcenters=this._circumcenters.subarray(0,triangles.length/3*2),i=0,j=0,n=triangles.length,x,y;i<n;i+=3,j+=2){y=2*
triangles[i];var t2=2*triangles[i+1],t3=2*triangles[i+2];x=points[y];y=points[y+1];var x3=points[t3],y3=points[t3+1];t3=points[t2]-x;var dy=points[t2+1]-y;t2=x3-x;var ey=y3-y,ab=2*(t3*ey-dy*t2);1E-9>Math.abs(ab)?(t3=1E9,dy=2*triangles[0],t3*=Math.sign((points[dy]-x)*ey-(points[dy+1]-y)*t2),x=(x+x3)/2-t3*ey,y=(y+y3)/2+t3*t2):(x3=1/ab,y3=t3*t3+dy*dy,ab=t2*t2+ey*ey,x+=(ey*y3-dy*ab)*x3,y+=(t3*ab-t2*y3)*x3);circumcenters[j]=x;circumcenters[j+1]=y}triangles=hull[hull.length-1];i=4*triangles;n=points[2*
triangles];y=points[2*triangles+1];_this$delaunay.fill(0);for(t2=0;t2<hull.length;++t2)triangles=hull[t2],circumcenters=i,j=n,x=y,i=4*triangles,n=points[2*triangles],y=points[2*triangles+1],_this$delaunay[circumcenters+2]=_this$delaunay[i]=x-y,_this$delaunay[circumcenters+3]=_this$delaunay[i+1]=n-j}},{key:"render",value:function(context){var buffer=null==context?context=new _path["default"]:void 0,_this$delaunay2=this.delaunay,halfedges=_this$delaunay2.halfedges,inedges=_this$delaunay2.inedges;_this$delaunay2=
_this$delaunay2.hull;var circumcenters=this.circumcenters,vectors=this.vectors;if(1>=_this$delaunay2.length)return null;for(var i=0,n=halfedges.length;i<n;++i){var j=halfedges[i];if(!(j<i)){var ti=2*Math.floor(i/3);j=2*Math.floor(j/3);this._renderSegment(circumcenters[ti],circumcenters[ti+1],circumcenters[j],circumcenters[j+1],context)}}halfedges=_this$delaunay2[_this$delaunay2.length-1];for(i=0;i<_this$delaunay2.length;++i)j=halfedges,halfedges=_this$delaunay2[i],ti=2*Math.floor(inedges[halfedges]/
3),n=circumcenters[ti],ti=circumcenters[ti+1],j*=4,(j=this._project(n,ti,vectors[j+2],vectors[j+3]))&&this._renderSegment(n,ti,j[0],j[1],context);return buffer&&buffer.value()}},{key:"renderBounds",value:function(context){var buffer=null==context?context=new _path["default"]:void 0;context.rect(this.xmin,this.ymin,this.xmax-this.xmin,this.ymax-this.ymin);return buffer&&buffer.value()}},{key:"renderCell",value:function(i,context){var buffer=null==context?context=new _path["default"]:void 0;i=this._clip(i);
if(null!==i&&i.length){context.moveTo(i[0],i[1]);for(var n=i.length;i[0]===i[n-2]&&i[1]===i[n-1]&&1<n;)n-=2;for(var _i4=2;_i4<n;_i4+=2)i[_i4]===i[_i4-2]&&i[_i4+1]===i[_i4-1]||context.lineTo(i[_i4],i[_i4+1]);context.closePath();return buffer&&buffer.value()}}},{key:"cellPolygons",value:regeneratorRuntime.mark(function cellPolygons(){var points,i,n,cell;return regeneratorRuntime.wrap(function(_context){for(;;)switch(_context.prev=_context.next){case 0:points=this.delaunay.points,i=0,n=points.length/
2;case 2:if(!(i<n)){_context.next=11;break}cell=this.cellPolygon(i);if(!cell){_context.next=8;break}cell.index=i;_context.next=8;return cell;case 8:++i;_context.next=2;break;case 11:case "end":return _context.stop()}},cellPolygons,this)})},{key:"cellPolygon",value:function(i){var polygon=new _polygon["default"];this.renderCell(i,polygon);return polygon.value()}},{key:"_renderSegment",value:function(x0,y0,x1,y1,context){var c0=this._regioncode(x0,y0),c1=this._regioncode(x1,y1);if(0===c0&&0===c1)context.moveTo(x0,
y0),context.lineTo(x1,y1);else if(x0=this._clipSegment(x0,y0,x1,y1,c0,c1))context.moveTo(x0[0],x0[1]),context.lineTo(x0[2],x0[3])}},{key:"contains",value:function(i,x,y){return(x=+x,x!==x)||(y=+y,y!==y)?!1:this.delaunay._step(i,x,y)===i}},{key:"neighbors",value:regeneratorRuntime.mark(function neighbors(i){var ci,_iteratorNormalCompletion,_didIteratorError,_iteratorError,_iterator,_step,j,cj,ai,li,aj,lj;return regeneratorRuntime.wrap(function(_context2){for(;;)switch(_context2.prev=_context2.next){case 0:ci=
this._clip(i);if(!ci){_context2.next=42;break}_iteratorNormalCompletion=!0;_didIteratorError=!1;_iteratorError=void 0;_context2.prev=5;_iterator=this.delaunay.neighbors(i)[Symbol.iterator]();case 7:if(_iteratorNormalCompletion=(_step=_iterator.next()).done){_context2.next=28;break}j=_step.value;cj=this._clip(j);if(!cj){_context2.next=25;break}ai=0;li=ci.length;case 12:if(!(ai<li)){_context2.next=25;break}aj=0;lj=cj.length;case 14:if(!(aj<lj)){_context2.next=22;break}if(ci[ai]!=cj[aj]||ci[ai+1]!=cj[aj+
1]||ci[(ai+2)%li]!=cj[(aj+lj-2)%lj]||ci[(ai+3)%li]!=cj[(aj+lj-1)%lj]){_context2.next=19;break}_context2.next=18;return j;case 18:return _context2.abrupt("break",25);case 19:aj+=2;_context2.next=14;break;case 22:ai+=2;_context2.next=12;break;case 25:_iteratorNormalCompletion=!0;_context2.next=7;break;case 28:_context2.next=34;break;case 30:_context2.prev=30,_context2.t0=_context2["catch"](5),_didIteratorError=!0,_iteratorError=_context2.t0;case 34:if(_context2.prev=34,_context2.prev=35,!_iteratorNormalCompletion&&
null!=_iterator["return"])_iterator["return"]();case 37:_context2.prev=37;if(!_didIteratorError){_context2.next=40;break}throw _iteratorError;case 40:return _context2.finish(37);case 41:return _context2.finish(34);case 42:case "end":return _context2.stop()}},neighbors,this,[[5,30,34,42],[35,,37,41]])})},{key:"_cell",value:function(i){var circumcenters=this.circumcenters,_this$delaunay3=this.delaunay,halfedges=_this$delaunay3.halfedges,triangles=_this$delaunay3.triangles;_this$delaunay3=_this$delaunay3.inedges[i];
if(-1===_this$delaunay3)return null;var points=[],e=_this$delaunay3;do{var t=Math.floor(e/3);points.push(circumcenters[2*t],circumcenters[2*t+1]);e=2===e%3?e-2:e+1;if(triangles[e]!==i)break;e=halfedges[e]}while(e!==_this$delaunay3&&-1!==e);return points}},{key:"_clip",value:function(i){if(0===i&&1===this.delaunay.hull.length)return[this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax,this.xmin,this.ymin];var points=this._cell(i);if(null===points)return null;var V=this.vectors,v=4*i;return V[v]||
V[v+1]?this._clipInfinite(i,points,V[v],V[v+1],V[v+2],V[v+3]):this._clipFinite(i,points)}},{key:"_clipFinite",value:function(i,points){for(var n=points.length,P=null,x0,y0,x1=points[n-2],y1=points[n-1],c0,c1=this._regioncode(x1,y1),e0,e1=0,j=0;j<n;j+=2)if(x0=x1,y0=y1,x1=points[j],y1=points[j+1],c0=c1,c1=this._regioncode(x1,y1),0===c0&&0===c1)e1=0,P?P.push(x1,y1):P=[x1,y1];else{if(0===c0){if(null===(x0=this._clipSegment(x0,y0,x1,y1,c0,c1)))continue;y0=_slicedToArray(x0,4);x0=y0[2];c0=y0[3]}else{if(null===
(x0=this._clipSegment(x1,y1,x0,y0,c1,c0)))continue;e0=_slicedToArray(x0,4);x0=e0[0];c0=e0[1];y0=e0[2];var sy0=e0[3];e0=e1;e1=this._edgecode(y0,sy0);e0&&e1&&this._edge(i,e0,e1,P,P.length);P?P.push(y0,sy0):P=[y0,sy0]}e0=e1;e1=this._edgecode(x0,c0);e0&&e1&&this._edge(i,e0,e1,P,P.length);P?P.push(x0,c0):P=[x0,c0]}if(P)e0=e1,e1=this._edgecode(P[0],P[1]),e0&&e1&&this._edge(i,e0,e1,P,P.length);else if(this.contains(i,(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2))return[this.xmax,this.ymin,this.xmax,this.ymax,
this.xmin,this.ymax,this.xmin,this.ymin];return P}},{key:"_clipSegment",value:function(x0,y0,x1,y1,c0,c1){for(;;){if(0===c0&&0===c1)return[x0,y0,x1,y1];if(c0&c1)return null;var x=c0||c1;if(x&8){x=x0+(x1-x0)*(this.ymax-y0)/(y1-y0);var y=this.ymax}else x&4?(x=x0+(x1-x0)*(this.ymin-y0)/(y1-y0),y=this.ymin):x&2?(y=y0+(y1-y0)*(this.xmax-x0)/(x1-x0),x=this.xmax):(y=y0+(y1-y0)*(this.xmin-x0)/(x1-x0),x=this.xmin);c0?(x0=x,y0=y,c0=this._regioncode(x0,y0)):(x1=x,y1=y,c1=this._regioncode(x1,y1))}}},{key:"_clipInfinite",
value:function(i,points,vx0,vy0,vxn,vyn){points=Array.from(points);var p;(p=this._project(points[0],points[1],vx0,vy0))&&points.unshift(p[0],p[1]);(p=this._project(points[points.length-2],points[points.length-1],vxn,vyn))&&points.push(p[0],p[1]);if(points=this._clipFinite(i,points))for(vx0=0,vy0=points.length,vyn=this._edgecode(points[vy0-2],points[vy0-1]);vx0<vy0;vx0+=2)vxn=vyn,vyn=this._edgecode(points[vx0],points[vx0+1]),vxn&&vyn&&(vx0=this._edge(i,vxn,vyn,points,vx0),vy0=points.length);else this.contains(i,
(this.xmin+this.xmax)/2,(this.ymin+this.ymax)/2)&&(points=[this.xmin,this.ymin,this.xmax,this.ymin,this.xmax,this.ymax,this.xmin,this.ymax]);return points}},{key:"_edge",value:function(i,e0,e1,P,j){for(;e0!==e1;){var x=void 0,y=void 0;switch(e0){case 5:e0=4;continue;case 4:e0=6;x=this.xmax;y=this.ymin;break;case 6:e0=2;continue;case 2:e0=10;x=this.xmax;y=this.ymax;break;case 10:e0=8;continue;case 8:e0=9;x=this.xmin;y=this.ymax;break;case 9:e0=1;continue;case 1:e0=5,x=this.xmin,y=this.ymin}P[j]===
x&&P[j+1]===y||!this.contains(i,x,y)||(P.splice(j,0,x,y),j+=2)}if(4<P.length)for(i=0;i<P.length;i+=2)if(e0=(i+2)%P.length,e1=(i+4)%P.length,P[i]===P[e0]&&P[e0]===P[e1]||P[i+1]===P[e0+1]&&P[e0+1]===P[e1+1])P.splice(e0,2),i-=2;return j}},{key:"_project",value:function(x0,y0,vx,vy){var t=Infinity,c;if(0>vy){if(y0<=this.ymin)return null;if((c=(this.ymin-y0)/vy)<t){var y=this.ymin;var x=x0+(t=c)*vx}}else if(0<vy){if(y0>=this.ymax)return null;(c=(this.ymax-y0)/vy)<t&&(y=this.ymax,x=x0+(t=c)*vx)}if(0<vx){if(x0>=
this.xmax)return null;(c=(this.xmax-x0)/vx)<t&&(x=this.xmax,y=y0+c*vy)}else if(0>vx){if(x0<=this.xmin)return null;(c=(this.xmin-x0)/vx)<t&&(x=this.xmin,y=y0+c*vy)}return[x,y]}},{key:"_edgecode",value:function(x,y){return(x===this.xmin?1:x===this.xmax?2:0)|(y===this.ymin?4:y===this.ymax?8:0)}},{key:"_regioncode",value:function(x,y){return(x<this.xmin?1:x>this.xmax?2:0)|(y<this.ymin?4:y>this.ymax?8:0)}}]);return Voronoi}();exports["default"]=global}
//# sourceMappingURL=module$node_modules$d3_delaunay$src$voronoi.js.map
